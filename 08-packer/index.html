<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="turbo-root" content="/odc">
    <meta name="turbo-cache-control" content="no-cache" data-turbo-track="reload" data-track-token="2.4.0.727116679119">

    <!-- See retype.com -->
    <meta name="generator" content="Retype 2.4.0">

    <!-- Primary Meta Tags -->
    <title>Packer</title>
    <meta name="title" content="Packer">
    <meta name="description" content="As we know a packer is a type of malware that has an encrypted payload in order to avoid detection during static analysis." />

    <!-- Canonical -->
    <link rel="canonical" href="https://francesco-plt.github.io/odc/08-packer/" />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://francesco-plt.github.io/odc/08-packer/">
    <meta property="og:title" content="Packer">
    <meta property="og:description" content="As we know a packer is a type of malware that has an encrypted payload in order to avoid detection during static analysis.">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://francesco-plt.github.io/odc/08-packer/">
    <meta property="twitter:title" content="Packer">
    <meta property="twitter:description" content="As we know a packer is a type of malware that has an encrypted payload in order to avoid detection during static analysis.">

    <script>(function () { var el = document.documentElement, m = localStorage.getItem("/odc/doc_theme"), wm = window.matchMedia; if (m === "dark" || (!m && wm && wm("(prefers-color-scheme: dark)").matches)) { el.classList.add("dark") } else { el.classList.remove("dark") } })();</script>

    <link href="../resources/css/retype.css?v=2.4.0.727116679119" rel="stylesheet" />

    <script type="text/javascript" src="../resources/js/config.js?v=2.4.0.727116679119" data-turbo-eval="false" defer></script>
    <script type="text/javascript" src="../resources/js/retype.js?v=2.4.0" data-turbo-eval="false" defer></script>
    <script id="lunr-js" type="text/javascript" src="../resources/js/lunr.js?v=2.4.0.727116679119" data-turbo-eval="false" defer></script>
    <script id="prism-js" type="text/javascript" src="../resources/js/prism.js?v=2.4.0.727116679119" defer></script>
</head>
<body>
    <div id="docs-app" class="relative text-base antialiased text-gray-700 bg-white font-body dark:bg-dark-850 dark:text-dark-300">
        <div class="absolute bottom-0 left-0 bg-gray-100 dark:bg-dark-800" style="top: 5rem; right: 50%"></div>
    
        <header id="docs-site-header" class="sticky top-0 z-30 flex w-full h-16 bg-white border-b border-gray-200 md:h-20 dark:bg-dark-850 dark:border-dark-650">
            <div class="container relative flex items-center justify-between grow pr-6 md:justify-start">
                <!-- Mobile menu button skeleton -->
                <button v-cloak class="skeleton docs-mobile-menu-button flex items-center justify-center shrink-0 overflow-hidden dark:text-white focus:outline-none rounded-full w-10 h-10 ml-3.5 md:hidden"><svg xmlns="http://www.w3.org/2000/svg" class="mb-px shrink-0" width="24" height="24" viewBox="0 0 24 24" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor"><path d="M2 4h20v2H2zM2 11h20v2H2zM2 18h20v2H2z"></path></g></svg></button>
                <div v-cloak id="docs-sidebar-toggle"></div>
        
                <!-- Logo -->
                <div class="flex items-center justify-between h-full py-2 md:w-75">
                    <div class="flex items-center px-2 md:px-6">
                        <a id="docs-site-logo" href="../" class="flex items-center leading-snug text-xl">
                            <span class="dark:text-white font-semibold line-clamp-1 md:line-clamp-2">Offensive and Defensive Cybersecurity</span>
                        </a><span class="hidden px-2 py-1 ml-4 text-sm font-semibold leading-none text-root-logo-label-text bg-root-logo-label-bg rounded-sm md:inline-block">Challenges summary &amp; write-up</span>
                    </div>
        
                    <span class="hidden h-8 border-r md:inline-block dark:border-dark-650"></span>
                </div>
        
                <div class="flex justify-between md:grow">
                    <!-- Top Nav -->
                    <nav class="hidden md:flex">
                        <ul class="flex flex-col mb-4 md:pl-16 md:mb-0 md:flex-row md:items-center">
                            <li class="mr-6">
                                <a class="py-2 md:mb-0 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="https://github.com/francesco-plt/">My GitHub</a>
                            </li>
                            <li class="mr-6">
                                <a class="py-2 md:mb-0 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="https://webeep.polimi.it/course/view.php?id=2636">Course Page on Webeep</a>
                            </li>
        
                        </ul>
                    </nav>
        
                    <!-- Header Right Skeleton -->
                    <div v-cloak class="flex justify-end grow skeleton">
        
                        <!-- Search input mock -->
                        <div class="relative hidden w-40 lg:block lg:max-w-sm lg:ml-auto">
                            <div class="absolute flex items-center justify-center h-full pl-3 dark:text-dark-300">
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon-base" width="16" height="16" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation"  style="margin-bottom: 1px;"><g fill="currentColor" ><path d="M21.71 20.29l-3.68-3.68A8.963 8.963 0 0020 11c0-4.96-4.04-9-9-9s-9 4.04-9 9 4.04 9 9 9c2.12 0 4.07-.74 5.61-1.97l3.68 3.68c.2.19.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.03 0-1.42zM4 11c0-3.86 3.14-7 7-7s7 3.14 7 7c0 1.92-.78 3.66-2.04 4.93-.01.01-.02.01-.02.01-.01.01-.01.01-.01.02A6.98 6.98 0 0111 18c-3.86 0-7-3.14-7-7z" ></path></g></svg>
                            </div>
        
                            <input class="w-full h-10 transition-colors duration-200 ease-in bg-gray-200 border border-transparent rounded md:text-sm hover:bg-white hover:border-gray-300 focus:outline-none focus:bg-white focus:border-gray-500 dark:bg-dark-600 dark:border-dark-600 placeholder-gray-400 dark:placeholder-dark-400"
                            style="padding: 0.625rem 0.75rem 0.625rem 2rem" type="text" placeholder="Search" />
                        </div>
        
                        <!-- Mobile search button mock -->
                        <div class="flex items-center justify-center w-10 h-10 lg:hidden">
                            <svg xmlns="http://www.w3.org/2000/svg" class="shrink-0 icon-base" width="20" height="20" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation"  style="margin-bottom: 0px;"><g fill="currentColor" ><path d="M21.71 20.29l-3.68-3.68A8.963 8.963 0 0020 11c0-4.96-4.04-9-9-9s-9 4.04-9 9 4.04 9 9 9c2.12 0 4.07-.74 5.61-1.97l3.68 3.68c.2.19.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.03 0-1.42zM4 11c0-3.86 3.14-7 7-7s7 3.14 7 7c0 1.92-.78 3.66-2.04 4.93-.01.01-.02.01-.02.01-.01.01-.01.01-.01.02A6.98 6.98 0 0111 18c-3.86 0-7-3.14-7-7z" ></path></g></svg>
                        </div>
        
                        <!-- Dark mode switch placehokder -->
                        <div class="w-10 h-10 lg:ml-2"></div>
        
                        <!-- History button mock -->
                        <div class="flex items-center justify-center w-10 h-10" style="margin-right: -0.625rem;">
                            <svg xmlns="http://www.w3.org/2000/svg" class="shrink-0 icon-base" width="22" height="22" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation"  style="margin-bottom: 0px;"><g fill="currentColor" ><g ><path d="M12.01 6.01c-.55 0-1 .45-1 1V12a1 1 0 00.4.8l3 2.22a.985.985 0 001.39-.2.996.996 0 00-.21-1.4l-2.6-1.92V7.01c.02-.55-.43-1-.98-1z"></path><path d="M12.01 1.91c-5.33 0-9.69 4.16-10.05 9.4l-.29-.26a.997.997 0 10-1.34 1.48l1.97 1.79c.19.17.43.26.67.26s.48-.09.67-.26l1.97-1.79a.997.997 0 10-1.34-1.48l-.31.28c.34-4.14 3.82-7.41 8.05-7.41 4.46 0 8.08 3.63 8.08 8.09s-3.63 8.08-8.08 8.08c-2.18 0-4.22-.85-5.75-2.4a.996.996 0 10-1.42 1.4 10.02 10.02 0 007.17 2.99c5.56 0 10.08-4.52 10.08-10.08.01-5.56-4.52-10.09-10.08-10.09z"></path></g></g></svg>
                        </div>
                    </div>
        
                    <div v-cloak class="flex justify-end grow">
                        <div id="docs-mobile-search-button"></div>
                        <doc-search-desktop></doc-search-desktop>
        
                        <doc-theme-switch class="lg:ml-2"></doc-theme-switch>
                        <doc-history></doc-history>
                    </div>
                </div>
            </div>
        </header>
    
        <div class="container relative flex bg-white">
            <!-- Sidebar Skeleton -->
            <div v-cloak class="fixed flex flex-col shrink-0 duration-300 ease-in-out bg-gray-100 border-gray-200 sidebar top-20 w-75 border-r h-screen md:sticky transition-transform skeleton dark:bg-dark-800 dark:border-dark-650">
            
                <!-- Render this div, if config.showSidebarFilter is `true` -->
                <div class="flex items-center h-16 px-6">
                    <input class="w-full h-8 px-3 py-2 transition-colors duration-200 ease-linear bg-white border border-gray-200 rounded shadow-none text-sm focus:outline-none focus:border-gray-600 dark:bg-dark-600 dark:border-dark-600" type="text" placeholder="Filter" />
                </div>
            
                <div class="pl-6 mb-4 mt-1">
                    <div class="w-32 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-48 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-40 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-32 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-48 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-40 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                </div>
            
                <div class="shrink-0 mt-auto bg-transparent dark:border-dark-650">
                    <a class="flex items-center justify-center flex-nowrap h-16 text-gray-400 dark:text-dark-400 hover:text-gray-700 dark:hover:text-dark-300 transition-colors duration-150 ease-in docs-powered-by" target="_blank" href="https://retype.com/" rel="noopener">
                        <span class="text-xs whitespace-nowrap">Powered by</span>
                        <svg xmlns="http://www.w3.org/2000/svg" class="ml-2" fill="currentColor" width="96" height="20" overflow="visible"><path d="M0 0v20h13.59V0H0zm11.15 17.54H2.44V2.46h8.71v15.08zM15.8 20h2.44V4.67L15.8 2.22zM20.45 6.89V20h2.44V9.34z"/><g><path d="M40.16 8.44c0 1.49-.59 2.45-1.75 2.88l2.34 3.32h-2.53l-2.04-2.96h-1.43v2.96h-2.06V5.36h3.5c1.43 0 2.46.24 3.07.73s.9 1.27.9 2.35zm-2.48 1.1c.26-.23.38-.59.38-1.09 0-.5-.13-.84-.4-1.03s-.73-.28-1.39-.28h-1.54v2.75h1.5c.72 0 1.2-.12 1.45-.35zM51.56 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92h4.74v1.83h-6.79V5.36h6.64zM60.09 7.15v7.48h-2.06V7.15h-2.61V5.36h7.28v1.79h-2.61zM70.81 14.64h-2.06v-3.66l-3.19-5.61h2.23l1.99 3.45 1.99-3.45H74l-3.19 5.61v3.66zM83.99 6.19c.65.55.97 1.4.97 2.55s-.33 1.98-1 2.51-1.68.8-3.04.8h-1.23v2.59h-2.06V5.36h3.26c1.42 0 2.45.28 3.1.83zm-1.51 3.65c.25-.28.37-.69.37-1.22s-.16-.92-.48-1.14c-.32-.23-.82-.34-1.5-.34H79.7v3.12h1.38c.68 0 1.15-.14 1.4-.42zM95.85 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92H96v1.83h-6.79V5.36h6.64z"/></g></svg>
                    </a>
                </div>
            </div>
            
            <!-- Sidebar component -->
            <doc-sidebar v-cloak>
                <template #sidebar-footer>
                    <div class="shrink-0 mt-auto border-t md:bg-transparent md:border-none dark:border-dark-650">
            
                        <div class="py-3 px-6 md:hidden border-b dark:border-dark-650">
                            <nav>
                                <ul class="flex flex-wrap justify-center items-center">
                                    <li class="mr-6">
                                        <a class="block py-1 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="https://github.com/francesco-plt/">My GitHub</a>
                                    </li>
                                    <li class="mr-6">
                                        <a class="block py-1 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="https://webeep.polimi.it/course/view.php?id=2636">Course Page on Webeep</a>
                                    </li>
            
                                </ul>
                            </nav>
                        </div>
            
                        <a class="flex items-center justify-center flex-nowrap h-16 text-gray-400 dark:text-dark-400 hover:text-gray-700 dark:hover:text-dark-300 transition-colors duration-150 ease-in docs-powered-by" target="_blank" href="https://retype.com/" rel="noopener">
                            <span class="text-xs whitespace-nowrap">Powered by</span>
                            <svg xmlns="http://www.w3.org/2000/svg" class="ml-2" fill="currentColor" width="96" height="20" overflow="visible"><path d="M0 0v20h13.59V0H0zm11.15 17.54H2.44V2.46h8.71v15.08zM15.8 20h2.44V4.67L15.8 2.22zM20.45 6.89V20h2.44V9.34z"/><g><path d="M40.16 8.44c0 1.49-.59 2.45-1.75 2.88l2.34 3.32h-2.53l-2.04-2.96h-1.43v2.96h-2.06V5.36h3.5c1.43 0 2.46.24 3.07.73s.9 1.27.9 2.35zm-2.48 1.1c.26-.23.38-.59.38-1.09 0-.5-.13-.84-.4-1.03s-.73-.28-1.39-.28h-1.54v2.75h1.5c.72 0 1.2-.12 1.45-.35zM51.56 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92h4.74v1.83h-6.79V5.36h6.64zM60.09 7.15v7.48h-2.06V7.15h-2.61V5.36h7.28v1.79h-2.61zM70.81 14.64h-2.06v-3.66l-3.19-5.61h2.23l1.99 3.45 1.99-3.45H74l-3.19 5.61v3.66zM83.99 6.19c.65.55.97 1.4.97 2.55s-.33 1.98-1 2.51-1.68.8-3.04.8h-1.23v2.59h-2.06V5.36h3.26c1.42 0 2.45.28 3.1.83zm-1.51 3.65c.25-.28.37-.69.37-1.22s-.16-.92-.48-1.14c-.32-.23-.82-.34-1.5-.34H79.7v3.12h1.38c.68 0 1.15-.14 1.4-.42zM95.85 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92H96v1.83h-6.79V5.36h6.64z"/></g></svg>
                        </a>
                    </div>
                </template>
            </doc-sidebar>
    
            <div class="grow min-w-0 dark:bg-dark-850">
                <!-- Render "toolbar" template here on api pages --><!-- Render page content -->
                <div class="flex">
                    <div class="grow min-w-0 px-6 md:px-16">
                        <main class="relative pt-6 pb-16">
                            <div class="docs-markdown" id="docs-content">
                                <!-- Rendered if sidebar right is enabled -->
                                <div id="docs-sidebar-right-toggle"></div>
                
                                <!-- Page content  -->
<doc-anchor-target id="packer" class="break-words">
    <h1>
        <doc-anchor-trigger class="header-anchor-trigger" to="#packer">#</doc-anchor-trigger>
        <span>Packer</span>
    </h1>
</doc-anchor-target>
<doc-anchor-target id="john">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#john">#</doc-anchor-trigger>
        <span>john</span>
    </h2>
</doc-anchor-target>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ file john
john: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=297bb194bf0ae17829e37240b7c7b6aa8a327572, stripped</code></pre>
</doc-codeblock></div>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">[*] '/home/zerocool/chall/todo/john/john'
    Arch:     i386-32-little
    RELRO:    Partial RELRO
    Stack:    Canary found
    NX:       NX enabled
    PIE:      No PIE (0x8048000)</code></pre>
</doc-codeblock></div>
<p>As we know a packer is a type of malware that has an encrypted payload in order to avoid detection during static analysis. At runtime the malicious portion of the code is unpacked, and execute. This means that we need to look for some procedure that manipulates the <code v-pre>.text</code> section of the executable. From <a href="https://liveoverflow.com/unpacking-buhtrap-malware-basics-of-self-injection-packers-ft-oalabs-2/">Unpacking Redaman Malware &amp; Basics of Self-Injection Packers - ft. OALabs (liveoverflow.com)</a>:</p>
<blockquote>
<p>Self-Injection is just one of the techniques used by malware authors for obfuscation, there are many other techniques like <em>Process Injection</em> (or <em>Process Hollowing</em>), <em>Classic DLL Injection</em> and <em>Thread Execution Hijacking</em>. There are a few different techniques for Self-Injection itself, but a common technique is to first unpack a small stub in-memory, it transfers the execution to the stub, <u>the stub code then changes the permission of a section in the process</u>, write the malicious code into those sections and transfer the execution back to the overwritten sections of the PE file.</p>
</blockquote>
<p>We have something similare here:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-c"><code v-pre class="language-c">int unpack(uint *param_1,int param_2) {
  uint uVar1;
  uint *puVar2;
  int iVar3;

  mprotect((void *)((uint)param_1 &amp; 0xfffff000),0x1000,7);
  uVar1 = *(uint *)(&amp;PTR_DAT_0804c03c)[(int)param_1 % 5];
  puVar2 = param_1;
  iVar3 = param_2;
  do {
    *puVar2 = *puVar2 ^ uVar1;
    puVar2 = puVar2 + 1;
    iVar3 = iVar3 + -1;
  } while (iVar3 != 0);
  (*(code *)param_1)();
  iVar3 = FUN_080491e6(param_1,param_2);
  return iVar3;
}</code></pre>
</doc-codeblock></div>
<p>The first argument of the <code v-pre>mprotect</code> is the address in memory from which we want to start changing permissions. The length is 4096 bytes. This probably means that the malicious code segment is located at <code v-pre>param_1</code>. By looking at the code at runtime, we can see that the address on which the <code v-pre>mprotect</code> is called is probably <strong><code v-pre>0x804970e</code></strong>. Also it looks like it ends at <code v-pre>0x804990e</code>. This means that it is located in this memory page:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash"> 0x8049000  0x804a000 r-xp     1000 1000   /home/zerocool/chall/todo/john/john</code></pre>
</doc-codeblock></div>
<p>which is also the only executable page of the <code v-pre>.text</code> section. This should be the code we want to examine to find the correct key for this binary:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-nasm"><code v-pre class="language-nasm">pwndbg&gt; b *0x0804970e
Breakpoint 1 at 0804970e
pwndbg&gt; r
pwndbg&gt; x/30gi 0x804970e
=&gt; 0x804970e:	pop    ss
   0x804970f:	mov    ebp,esp
   0x8049711:	sub    esp,0x18
   0x8049714:	cmp    DWORD PTR [ebp+0x18],0x1
   0x8049718:	jg     0x804973a
   0x804971a:	mov    eax,DWORD PTR [ebp+0x1c]
   0x804971d:	mov    eax,DWORD PTR [eax]
   0x804971f:	sub    esp,0x8
   0x8049722:	push   eax
   0x8049723:	push   0x804a0f8
   0x8049728:	call   0x8049050 &lt;printf@plt&gt;
   0x804972d:	add    esp,0x10
   0x8049730:	sub    esp,0xc
   0x8049733:	push   0x0
   0x8049735:	call   0x8049080 &lt;exit@plt&gt;
   0x804973a:	mov    DWORD PTR [ebp-0xc],0x0
   0x8049741:	mov    eax,DWORD PTR [ebp+0x1c]
   0x8049744:	add    eax,0x4
   0x8049747:	mov    eax,DWORD PTR [eax]
   0x8049749:	sub    esp,0x4
   0x804974c:	push   eax
   0x804974d:	push   0x11
   0x8049752:	push   0x80492a0
   0x8049757:	call   0x804922b
   0x804975c:	add    esp,0x10
   0x804975f:	add    DWORD PTR [ebp-0xc],eax
   0x8049762:	mov    eax,DWORD PTR [ebp+0x1c]
   0x8049765:	add    eax,0x4
   0x8049768:	mov    eax,DWORD PTR [eax]
   0x804976a:	sub    esp,0x4</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="notes-from-lesson">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#notes-from-lesson">#</doc-anchor-trigger>
        <span>Notes from lesson</span>
    </h3>
</doc-anchor-target>
<p>Basically I was almost right about what was happening here. We have that the main is calling an unpacking routine, which is the <code v-pre>unpack</code> function above. The <code v-pre>num</code> parameter is a counter for a loop:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-c"><code v-pre class="language-c">int unpack(uint *func,int size) {
  uint *cur_ptr;
  undefined4 uVar1;
  int count;
  uint key;
                    /* here we're preparing the memory page for malicious code */
  mprotect((void *)((uint)func &amp; 0xfffff000),0x1000,7);
  key = *(uint *)(&amp;arr)[(int)func % 5];
  cur_ptr = func;
  count = size;
  do {
    *cur_ptr = *cur_ptr ^ key;
    cur_ptr = cur_ptr + 1;
    count = count + -1;
  } while (count != 0);
  uVar1 = (*(code *)func)();
  count = pack(uVar1,func,size);
  return count;
}</code></pre>
</doc-codeblock></div>
<p>The counter is likely the size of the function to unpack. Note that the key used to decrypt the function depends on the address of the function itself.</p>
<p>We looked at the unpacking routine, but we&#x27;re still missing the main part.</p>
<doc-anchor-target id="where-do-we-start">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#where-do-we-start">#</doc-anchor-trigger>
        <span>Where do we start?</span>
    </h3>
</doc-anchor-target>
<p>We have two approaches:</p>
<ul>
<li><strong>Static</strong>: Since we understand the unpacking routine we can build an unpacker and look at it with ghidra.</li>
<li><strong>Dynamic</strong>: we could run the binary and use ghidra to look at the unpacked running code, or we can dump the memory of the running binary and look at it.</li>
</ul>
<doc-anchor-target id="dynamic-approach">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#dynamic-approach">#</doc-anchor-trigger>
        <span>Dynamic approach</span>
    </h3>
</doc-anchor-target>
<p>We&#x27;ll break at the <code v-pre>unpack</code> function with gdb:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-c"><code v-pre class="language-c">unpack((char *)malicious_func_maybe,83,argc,argv);</code></pre>
</doc-codeblock></div>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-nasm"><code v-pre class="language-nasm">                         *******************************************************
                         *                      FUNCTION                       *
                         *******************************************************
                         undefined malicious_func_maybe()
           undefined       AL:1         &lt;RETURN&gt;
                         malicious_func_maybe                      XREF[3]:   																																				main:08049878(*),
                         																			0804a228,
                                                              0804a444(*)
      0804970e 17            POP       SS</code></pre>
</doc-codeblock></div>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-nasm"><code v-pre class="language-nasm">pwndbg&gt; b *0x0804970e
Breakpoint 1 at 0804970e
pwndbg&gt; r
pwndbg&gt; x/30gi 0x804970e
=&gt; 0x804970e:	pop    ss
   0x804970f:	mov    ebp,esp
   0x8049711:	sub    esp,0x18
   0x8049714:	cmp    DWORD PTR [ebp+0x18],0x1
   0x8049718:	jg     0x804973a
   0x804971a:	mov    eax,DWORD PTR [ebp+0x1c]
   0x804971d:	mov    eax,DWORD PTR [eax]
   0x804971f:	sub    esp,0x8
   0x8049722:	push   eax
   0x8049723:	push   0x804a0f8
   0x8049728:	call   0x8049050 &lt;printf@plt&gt;
   0x804972d:	add    esp,0x10
   0x8049730:	sub    esp,0xc
   0x8049733:	push   0x0
   0x8049735:	call   0x8049080 &lt;exit@plt&gt;
   0x804973a:	mov    DWORD PTR [ebp-0xc],0x0
   0x8049741:	mov    eax,DWORD PTR [ebp+0x1c]
   0x8049744:	add    eax,0x4
   0x8049747:	mov    eax,DWORD PTR [eax]
   0x8049749:	sub    esp,0x4
   0x804974c:	push   eax
   0x804974d:	push   0x11
   0x8049752:	push   0x80492a0
   0x8049757:	call   0x804922b
   0x804975c:	add    esp,0x10
   0x804975f:	add    DWORD PTR [ebp-0xc],eax
   0x8049762:	mov    eax,DWORD PTR [ebp+0x1c]
   0x8049765:	add    eax,0x4
   0x8049768:	mov    eax,DWORD PTR [eax]
   0x804976a:	sub    esp,0x4</code></pre>
</doc-codeblock></div>
<p>Ok up until now I was on the right track. My problem here was that I have no idea on how to read those assembly instructions...</p>
<p><strong>The problem is that what we&#x27;re looking at are packed instructions.</strong> If we break at the following line:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-c"><code v-pre class="language-c">uVar1 = (*(code *)func)();</code></pre>
</doc-codeblock></div>
<p>And we print the same memory cells we&#x27;ll see the real code used to get the key!</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-nasm"><code v-pre class="language-nasm">pwndbg&gt; b *0x0804928a
pwndbg&gt; x/30gi 0x804970e
pwndbg&gt; x/30gi 0x804970e
   0x804970e:	push   ebp
   0x804970f:	mov    ebp,esp
   0x8049711:	sub    esp,0x18
   0x8049714:	cmp    DWORD PTR [ebp+0x18],0x1
   0x8049718:	jg     0x804973a
   0x804971a:	mov    eax,DWORD PTR [ebp+0x1c]
   0x804971d:	mov    eax,DWORD PTR [eax]
   0x804971f:	sub    esp,0x8
   0x8049722:	push   eax
   0x8049723:	push   0x804a0f8
   0x8049728:	call   0x8049050 &lt;printf@plt&gt;
   0x804972d:	add    esp,0x10
   0x8049730:	sub    esp,0xc
   0x8049733:	push   0x0
   0x8049735:	call   0x8049080 &lt;exit@plt&gt;
   0x804973a:	mov    DWORD PTR [ebp-0xc],0x0
   0x8049741:	mov    eax,DWORD PTR [ebp+0x1c]
   0x8049744:	add    eax,0x4
   0x8049747:	mov    eax,DWORD PTR [eax]
   0x8049749:	sub    esp,0x4
   0x804974c:	push   eax
   0x804974d:	push   0x11
   0x8049752:	push   0x80492a0
   0x8049757:	call   0x804922b
   0x804975c:	add    esp,0x10
   0x804975f:	add    DWORD PTR [ebp-0xc],eax
   0x8049762:	mov    eax,DWORD PTR [ebp+0x1c]
   0x8049765:	add    eax,0x4
   0x8049768:	mov    eax,DWORD PTR [eax]
   0x804976a:	sub    esp,0x4</code></pre>
</doc-codeblock></div>
<p>Ok this makes sense: <code v-pre>push ebp</code> is how an actual disassembled function starts. Note that we have another function call:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-nasm"><code v-pre class="language-nasm">   0x8049757:	call   0x804922b</code></pre>
</doc-codeblock></div>
<p>Note that this could be another packer... Actually its the address of the <code v-pre>unpack</code> function. So we&#x27;re calling another function trough the unpacker. Here&#x27;s the new function:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-nasm"><code v-pre class="language-nasm">pwndbg&gt; x/30gi 0x80492a0
   0x80492a0:	push   ebp
   0x80492a1:	mov    ebp,esp
   0x80492a3:	sub    esp,0x18
   0x80492a6:	sub    esp,0x8
   0x80492a9:	push   0x804a039
   0x80492ae:	push   DWORD PTR [ebp+0x18]
   0x80492b1:	call   0x8049030 &lt;strstr@plt&gt;
   0x80492b6:	add    esp,0x10
   0x80492b9:	mov    DWORD PTR [ebp-0xc],eax
   0x80492bc:	mov    eax,DWORD PTR [ebp-0xc]
   0x80492bf:	cmp    eax,DWORD PTR [ebp+0x18]
   0x80492c2:	jne    0x80492cb
   0x80492c4:	mov    eax,0x1
   0x80492c9:	jmp    0x80492e3
   0x80492cb:	sub    esp,0x8
   0x80492ce:	push   DWORD PTR [ebp+0x18]
   0x80492d1:	push   0x804a03f
   0x80492d6:	call   0x8049050 &lt;printf@plt&gt;
   0x80492db:	add    esp,0x10
   0x80492de:	mov    eax,0x0
   0x80492e3:	leave
   0x80492e4:	ret
   0x80492e5:	pop    ss
   0x80492e6:	mov    ecx,0x38aec1d5
   0x80492eb:	mov    bl,0xae
   0x80492ed:	dec    esi
   0x80492ee:	iret
   0x80492ef:	inc    ebp
   0x80492f0:	pop    edx
   0x80492f1:	stos   BYTE PTR es:[edi],al</code></pre>
</doc-codeblock></div>
<p>If we look at the code with gdb:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-c"><code v-pre class="language-c">0x80492b1    call   strstr@plt                     &lt;strstr@plt&gt;
        haystack: 0xffffd518 &lt;— 'flag{esketit}'
        needle: 0x804a039 &lt;— 'flag{'</code></pre>
</doc-codeblock></div>
<p>We&#x27;ve got a call to the <code v-pre>strstr</code> function, and another call to the packer.</p>
<p><strong>From this behaviour we unedrstand that the check on the flag is performed incrementally by calling <code v-pre>unpack</code> and the <code v-pre>pack</code> on some code, and so on. This means that we&#x27;ll not have a point in time in which during execution the binary is completely unpacked.</strong> Extracting the unpacked code dynamically can be very time consuming, which means that a more efficient method would be to write a script that reverse engineer the packing algorithm, which then can be used to create a binary containing an unpacked payload. This is what the static approach does in a nutshell.</p>
<doc-anchor-target id="section">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#section">#</doc-anchor-trigger>
        <span></span>
    </h3>
</doc-anchor-target>
<p>Let&#x27;s reverse engineer the packer with python:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-python"><code v-pre class="language-python">import sys
from pwn import u32, p32

if len(sys.argv) &lt; 4:
    print(&quot;usage : %s &lt;inputfile&gt; &lt;address&gt; &lt;size&gt;&quot; % sys.argv[0])
    exit(0)

filepath = sys.argv[1]
address = int(sys.argv[2], 16)
size = int(sys.argv[3], 16)

BEG_BIN = 0x08048000
KEY = [0x04030201, 0x40302010, 0x42303042, 0x44414544, 0xffffffff]
ff = open(filepath, &quot;rb&quot;)
f = ff.read()
ff.close()

off = address - BEG_BIN
to_decode = f[off: off+(size*4)]
k = KEY[address % 5]

decode = b&quot;&quot;
for i in range(size):
    decode += p32(u32(to_decode[i*4: (i+1)*4]) ^ k)

f = f[:off] + decode + f[off+(size*4):]

ff = open(filepath, &quot;wb&quot;)
ff.write(f)
ff.close()</code></pre>
</doc-codeblock></div>
<p>This gives us a decent unpacked main:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-c"><code v-pre class="language-c">void FUN_0804970e(void)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int in_stack_00000014;
  undefined4 *in_stack_00000018;

  if (in_stack_00000014 &lt; 2) {
    printf(&quot;Usage:\n %s flag{&lt;key&gt;}\n&quot;,*in_stack_00000018);
                    /* WARNING: Subroutine does not return */
    exit(0);
  }
  iVar1 = FUN_0804922b(FUN_080492a0,0x11,in_stack_00000018[1]);
  iVar2 = FUN_0804922b(FUN_080492e5,0x11,in_stack_00000018[1]);
  iVar3 = FUN_0804922b(FUN_08049329,0x17,in_stack_00000018[1]);
  iVar4 = FUN_0804922b(FUN_080496ab,0x18,in_stack_00000018[1]);
  iVar5 = FUN_0804922b(FUN_080495e4,0x31,in_stack_00000018[1]);
  iVar6 = FUN_0804922b(FUN_08049546,0x27,in_stack_00000018[1],0);
  iVar7 = FUN_0804922b(FUN_0804951f,9,in_stack_00000018[1]);
  if (iVar1 + iVar2 + iVar3 + iVar4 + iVar5 + iVar6 + iVar7 == 7) {
    printf(&quot;\x1b[1;37mYou got the flag: \x1b[1;32m%s\x1b[0m\n&quot;,in_stack_00000018[1]);
  }
  else {
    printf(&quot;\x1b[1;31mLoser\n\x1b[0m&quot;);
  }
  return;
}</code></pre>
</doc-codeblock></div>
<p>We need to repeat this to unpack every function used to create the flag. The first three, as already seen, are respectively checks on the prefix (<code v-pre>flag{}</code>), the suffix (<code v-pre>}</code>) and the type of characters of the flag (must be ascii). The last one is a check on the flag length (==33). As for the other function we have the following structure:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">FUN_080496ab (0x18)
	FUN_08049385 (0x36)

FUN_080495e4 (0x31)
	FUN_0804945e (0x30)

FUN_08049546 (0x27)</code></pre>
</doc-codeblock></div>
<p>Where the indented functions are calls that are made inside the outer ones. The first function determines the first 6 characters of the flag, which are &#x27;packer&#x27;. We are still missing 21 characters, which are originated from <code v-pre>FUN_080495e4</code> and <code v-pre>FUN_08049546</code>.</p>
<doc-anchor-target id="fun_080496ab">
    <h5>
        <doc-anchor-trigger class="header-anchor-trigger" to="#fun_080496ab">#</doc-anchor-trigger>
        <span><code v-pre>FUN_080496ab</code></span>
    </h5>
</doc-anchor-target>
<p>After unpacking we get:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-c"><code v-pre class="language-c">int FUN_080496ab(void) {
  int flagchar;
  int in_stack_00000014;
  int i;
  char usrinput;

  i = 1;
  while( true ) {
    if (6 &lt; i) {
      return 1;
    }
    usrinput = *(char *)(in_stack_00000014 + i + 4);
    flagchar = FUN_0804922b(FUN_08049385,0x36,i);
    if (usrinput != flagchar) break;
    i = i + 1;
  }
  return 0;
}</code></pre>
</doc-codeblock></div>
<p>Ok looks like there&#x27;s another function to unpack: <code v-pre>FUN_08049385</code>, which becomes:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-c"><code v-pre class="language-c">int FUN_08049385(void) {
  double dVar1;
  double dVar2;
  double dVar3;
  double dVar4;
  int in_stack_00000014;

  dVar1 = pow((double)in_stack_00000014,5.0);
  dVar2 = pow((double)in_stack_00000014,4.0);
  dVar3 = pow((double)in_stack_00000014,3.0);
  dVar4 = pow((double)in_stack_00000014,2.0);
  return (int)((float)in_stack_00000014 * 99.65 +
               ((float)(dVar3 * 45.83333358 + (dVar1 * 0.5166666688 - dVar2 * 8.125000037)) -
               (float)dVar4 * 109.875) + 84.0);
}</code></pre>
</doc-codeblock></div>
<p>Which we can either reverse engineer with z3, or by looking at which characters are outputed in registers by using gdb (again dynamic approach). After reverse engineering this we&#x27;ll get that the first part of the flag is <code v-pre>flag{packer</code>. Since the flag is 33 chars long, we are still missing 21.</p>
<doc-anchor-target id="fun-080495e4">
    <h5>
        <doc-anchor-trigger class="header-anchor-trigger" to="#fun-080495e4">#</doc-anchor-trigger>
        <span><code v-pre> FUN_080495e4</code></span>
    </h5>
</doc-anchor-target>
<p>Looks like we need to reverse engineer this:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-c"><code v-pre class="language-c">undefined4 FUN_080495e4(void) {
  undefined4 uVar1;
  int i;
  undefined4 *puVar2;
  undefined4 *puVar3;
  int in_GS_OFFSET;
  int in_stack_00000014;
  int j;
  undefined4 local_7c [23];
  int canary;

  canary = *(int *)(in_GS_OFFSET + 0x14);
  puVar2 = &amp;weird_string;
  puVar3 = local_7c;
                    /* filling local_7c with hardcoded data
                         */
  for (i = 22; i != 0; i = i + -1) {
    *puVar3 = *puVar2;
    puVar2 = puVar2 + 1;
    puVar3 = puVar3 + 1;
  }
  j = 0;
  do {
    if (10 &lt; j) {
      uVar1 = 1;
LAB_08049692:
                    /* exit */
      if (canary != *(int *)(in_GS_OFFSET + 0x14)) {
                    /* WARNING: Subroutine does not return */
        __stack_chk_fail();
      }
      return uVar1;
    }
                    /* here's the real magic */
    i = FUN_0804922b(FUN_0804945e,0x30,(int)*(char *)(in_stack_00000014 + j + 11),local_7c[j * 2],
                     local_7c[j * 2 + 1]);
    if (i == 0) {
      uVar1 = 0;
      goto LAB_08049692;
    }
    if ((*(byte *)(in_stack_00000014 + 0x11) &amp; 1) == 0) {
      uVar1 = 0;
      goto LAB_08049692;
    }
    j = j + 1;
  } while( true );
}</code></pre>
</doc-codeblock></div>
<p>WTF is this? From a first look it seems like we&#x27;re preparing <code v-pre>local_7c</code> and then we&#x27;re comparing its content with the flag passed by the user using <code v-pre>FUN_0804945e</code>. If for some reason the comparison does not go well the function is exited. More specifically it looks like we&#x27;re comparing each even character of <code v-pre>local_7c</code> and its successor with every character of the user input. This is the code that is doing the comparison:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-c"><code v-pre class="language-c">bool FUN_0804945e(void) {
  float10 fVar1;
  double dVar2;
  int in_stack_00000014;
  uint in_stack_00000018;
  uint in_stack_0000001c;
  uint local_34;
  uint uStack48;

  dVar2 = sqrt((double)in_stack_00000014);
  fVar1 = (float10)powl((float10)in_stack_00000014,SUB104((float10)dVar2,0),
                        (int6)((unkuint10)(float10)dVar2 &gt;&gt; 0x20));
  if (_DAT_0804a1a0 &lt;= fVar1) {
    local_34 = (uint)(longlong)ROUND(fVar1 - _DAT_0804a1a0);
    uStack48 = (uint)((ulonglong)(longlong)ROUND(fVar1 - _DAT_0804a1a0) &gt;&gt; 0x20);
    uStack48 = uStack48 ^ 0x80000000;
  }
  else {
    local_34 = (uint)(longlong)ROUND(fVar1);
    uStack48 = (uint)((ulonglong)(longlong)ROUND(fVar1) &gt;&gt; 0x20);
  }
  return (local_34 + 0x15 ^ in_stack_00000018 |
         uStack48 + (0xffffffea &lt; local_34) ^ in_stack_0000001c) == 0;
}</code></pre>
</doc-codeblock></div>
<p>First of all, this is the content of <code v-pre>local_7c</code>:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">DDE76FA6 1C000000 F8FC7A35 27020000 15000000 00000000 546C155C 6C010000 DDE76FA6 1C000000 66CE3EE9 9D000000 546C155C 6C010000 546C155C 6C010000 414244F3 56070000 C5A46046 01000000 DDE76FA6 1C000000</code></pre>
</doc-codeblock></div>
<p>Which is not something that really makes sense translated in ascii. Actually neither the content of <code v-pre>FUN_0804945e</code> makes sense, really. If fact I was so done that I tried to bruteforce the checks. Basically, we know that the return value of <code v-pre>FUN_0804945e</code> must be 1. This means that we can script the execution with a gdbinit and try every possible characters for every position of the flag checked by the function to find what we need.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ p y.py
13:22:02 - starting...
found a char:  flag{packer-
found a char:  flag{packer-4
found a char:  flag{packer-4a3
found a char:  flag{packer-4a3-
found a char:  flag{packer-4a3-1
found a char:  flag{packer-4a3-13
found a char:  flag{packer-4a3-133
found a char:  flag{packer-4a3-1337
finished. took 778.9688053131104 seconds
13:35:01 - characters found: -4a3-1337
exiting...</code></pre>
</doc-codeblock></div>
<p>Ok now we know that the flag up to now is: <code v-pre>flag{packer-4a3-1337</code> something <code v-pre>}</code>, where the missing part is 12 characters long.</p>
<doc-anchor-target id="fun_08049546">
    <h5>
        <doc-anchor-trigger class="header-anchor-trigger" to="#fun_08049546">#</doc-anchor-trigger>
        <span><code v-pre>FUN_08049546</code></span>
    </h5>
</doc-anchor-target>
<p>Ok we&#x27;re still missing 20 characters, identified by this function:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-c"><code v-pre class="language-c">undefined4 FUN_08049546(void) {
  size_t sVar1;
  undefined4 uVar2;
  char *in_stack_00000014;
  int in_stack_00000018;

  sVar1 = strlen(in_stack_00000014);
  if (in_stack_00000018 + 0x16U &lt; sVar1) {
    if ((char)(in_stack_00000014[in_stack_00000018 + 0x14] ^ (&amp;DAT_0804a081)[in_stack_00000018]) ==
        in_stack_00000014[in_stack_00000018 + 0x15]) {
      uVar2 = FUN_08049546(0xdeadb00b,0xdeadb00b,0xdeadb00b,0xdeadb00b,in_stack_00000014,
                           in_stack_00000018 + 1);
    }
    else {
      uVar2 = 0;
    }
  }
  else {
    uVar2 = 1;
  }
  return uVar2;
}</code></pre>
</doc-codeblock></div>
<p>After fixing the function signature with Ghidra it becomes:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-c"><code v-pre class="language-c">bool FUN_08049546(int a,int b,int c,int d,char *user_input,int index) {
  bool chk;
  int userin_len;
  userin_len = strlen(user_input);
  if (index + 22U &lt; (uint)userin_len) {
    if ((char)(user_input[index + 20] ^ (&amp;key)[index]) == user_input[index + 21]) {
      chk = FUN_08049546(L'\xdeadb00b',-0x21524ff5,-0x21524ff5,-0x21524ff5,user_input,index + 1);
    }
    else {
      chk = false;
    }
  }
  else {
    chk = true;
  }
  return chk;
}</code></pre>
</doc-codeblock></div>
<p>Ok this looks easy. <code v-pre>index</code> starts from zero. Every function call its incremented by one. The check performed every call compares <code v-pre>index</code>+22 against 33, which means that we&#x27;ll have 11 loop iterations. For evey iteration the character at <code v-pre>index</code>+20 of the flag is XORed with <code v-pre>key</code> and compared with its follower. Since the XOR is invertible, I think that we can reverse the process to get back the original characters. Using z3:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-python"><code v-pre class="language-python">from z3 import Solver, BitVec, Z3Exception
from IPython import embed
from string import printable

flag1 = 'flag{packer-4a3-1337'
orig_key = b'\x0b\x4c\x0f\x00\x01\x16\x10\x07\x09\x38\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
key = []
for i in range(len(orig_key)):
    key.append(orig_key[i])

print('charset length: %s' % len(printable))
for char in printable:
    print('\ntrying with %s...' % char)

    flagchars = [BitVec('flag_' + str(i), 32) for i in range(20, 31)]
    s = Solver()

    for i in range(0, 10):
        s.add(flagchars[i] ^ key[i] == flagchars[i+1])
    s.add(flagchars[0] == ord(char))

    s.check()
    try:
        m = s.model()
    except Z3Exception:
        continue

    flag = []
    for char in flag1:
        flag.append(char)

    j = 0
    for el in m:
        flag.append(chr(m[flagchars[j]].as_long()))
        j += 1
    flag.append('}')
    print(''.join(flag))
#embed()</code></pre>
</doc-codeblock></div>
<p>And with this we should be all set.</p>

                                
                                <!-- Required only on API pages -->
                                <doc-toolbar-member-filter-no-results />
                            </div>
                            <footer class="clear-both">
                                <div class="flex flex-wrap items-center justify-between mt-14">
                                    <a class="my-2.5 inline-flex items-center text-sm whitespace-nowrap text-blue-500 dark:text-blue-400 hover:text-blue-700 hover:underline" href="https://github.com/francesco-plt/odc/blob/main/08-packer.md" target="_blank" rel="noopener">
                                        <svg class="mr-1.5" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M20 12c-.55 0-1 .45-1 1v7c0 .55-.45 1-1 1H4c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h7c.55 0 1-.45 1-1s-.45-1-1-1H4C2.35 3 1 4.35 1 6v14c0 1.65 1.35 3 3 3h14c1.65 0 3-1.35 3-3v-7c0-.55-.45-1-1-1z" /><path d="M22.21 1.79c-1.18-1.18-3.24-1.18-4.41 0l-9.5 9.5c-.13.13-.22.29-.26.46l-1 4c-.08.34.01.7.26.95.18.2.44.3.7.3.08 0 .16-.01.24-.03l4-1c.18-.04.34-.13.46-.26l9.5-9.5c1.22-1.22 1.22-3.2.01-4.42zm-1.42 3l-9.3 9.3-2.11.53.53-2.11 9.3-9.3c.42-.42 1.16-.42 1.59 0 .43.43.43 1.15-.01 1.58z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                                        <span>Edit this page</span>
                                    </a>
                                </div>
                            
                                <nav class="flex mt-14">
                                    <div class="w-1/2">
                                        <a class="px-5 py-4 h-full flex items-center break-normal font-medium text-blue-500 dark:text-blue-400 border border-gray-300 hover:border-gray-400 dark:border-dark-650 dark:hover:border-dark-450 rounded-l-lg transition-colors duration-150 relative hover:z-5" href="../04-heap/">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="mr-3" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M19 11H7.41l5.29-5.29a.996.996 0 10-1.41-1.41l-7 7a1 1 0 000 1.42l7 7a1.024 1.024 0 001.42-.01.996.996 0 000-1.41L7.41 13H19c.55 0 1-.45 1-1s-.45-1-1-1z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                                            <span>
                                                <span class="block text-xs font-normal text-gray-400 dark:text-dark-400">Previous</span>
                                                <span class="block mt-1">Heap</span>
                                            </span>
                                        </a>
                                    </div>
                            
                                    <div class="w-1/2">
                                        <a class="px-5 py-4 -mx-px h-full flex items-center justify-end break-normal font-medium text-blue-500 dark:text-blue-400 border border-gray-300 hover:border-gray-400 dark:border-dark-650 dark:hover:border-dark-450 rounded-r-lg transition-colors duration-150 relative hover:z-5" href="../03-reversing/">
                                            <span>
                                                <span class="block text-xs font-normal text-right text-gray-400 dark:text-dark-400">Next</span>
                                                <span class="block mt-1">Reversing</span>
                                            </span>
                                            <svg xmlns="http://www.w3.org/2000/svg" class="ml-3" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M19.92 12.38a1 1 0 00-.22-1.09l-7-7a.996.996 0 10-1.41 1.41l5.3 5.3H5c-.55 0-1 .45-1 1s.45 1 1 1h11.59l-5.29 5.29a.996.996 0 000 1.41c.19.2.44.3.7.3s.51-.1.71-.29l7-7c.09-.09.16-.21.21-.33z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                                        </a>
                                    </div>
                                </nav>
                            </footer>
                        </main>
                
                        <div class="border-t dark:border-dark-650 pt-6 mb-8">
                            <footer class="flex flex-wrap items-center justify-between">
                                <div>
                                    <ul class="flex flex-wrap items-center text-sm">
                                        <li>
                                            <a class="block mr-4 py-2 text-sm whitespace-nowrap transition-colors duration-200 ease-linear text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200 md:mb-0" href="">License</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="docs-copyright py-2 text-gray-500 dark:text-dark-350 text-sm leading-relaxed"></div>
                            </footer>
                        </div>
                    </div>
                
                    <!-- Rendered if sidebar right is enabled -->
                    <!-- Sidebar right skeleton-->
                    <div v-cloak class="fixed top-0 bottom-0 right-0 translate-x-full bg-white border-gray-200 lg:sticky lg:border-l lg:shrink-0 lg:pt-6 lg:transform-none sm:w-1/2 lg:w-64 lg:z-0 md:w-104 sidebar-right skeleton dark:bg-dark-850 dark:border-dark-650">
                        <div class="pl-5">
                            <div class="w-32 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
                            <div class="w-48 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
                            <div class="w-40 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
                        </div>
                    </div>
                
                    <!-- User should be able to hide sidebar right -->
                    <doc-sidebar-right v-cloak></doc-sidebar-right>
                </div>

            </div>
        </div>
    
        <doc-search-mobile></doc-search-mobile>
        <doc-back-to-top></doc-back-to-top>
    </div>


    <div id="docs-overlay-target"></div>

    <script>window.__DOCS__ = { "title": "Packer", level: 1, icon: "file", hasPrism: true, hasMermaid: false, hasMath: false }</script>
</body>
</html>
